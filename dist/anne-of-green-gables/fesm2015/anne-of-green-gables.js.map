{"version":3,"file":"anne-of-green-gables.js","sources":["../../../projects/anne-of-green-gables/src/lib/anne-of-green-gables.service.ts","../../../projects/anne-of-green-gables/src/lib/anne-of-green-gables.component.ts","../../../projects/anne-of-green-gables/src/lib/anne-of-green-gables.module.ts","../../../projects/anne-of-green-gables/src/public-api.ts","../../../projects/anne-of-green-gables/src/anne-of-green-gables.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AnneOfGreenGablesService {\r\n\r\n  constructor() { }\r\n}\r\n","\r\nimport { Component, Input, OnInit, Output, EventEmitter, ViewEncapsulation } from '@angular/core';\r\n\r\nconst leafletNeshan = require('../src/assets/js/leafletNeshan.js');\r\n\r\n@Component({\r\n  selector: 'lib-anne-of-green-gables',\r\n  template: `\r\n  \r\n  <div id='map' style=\"width: 800px; height: 500px; background: #eee; border: 2px solid #aaa;\">  \r\n    <div class=\"leafleat-top leaflet-left\" style=\"position:absolute;width:34px;height:34px;z-index:20000;top:75px;left:10px;\">\r\n      <button style=\"height:34px;width:34px;\" (click)=\"moveToCurrentLocation()\">\r\n      <img src=\"../src/assets/icon/my-location.png\" style=\"position: relative;top: -3px;right: 5px;\">\r\n    </button>\r\n    <div class=\"leafleat-top leaflet-right\" style=\"position:absolute;width:34px;height:34px;z-index:20000;\">\r\n      <button style=\"height:34px;width:34px;\" (click)=\"removeMarkers()\">rm</button>\r\n    </div> \r\n  </div>\r\n  `,\r\n  styleUrls: [\r\n    '../assets/style/leafletNeshan.css'\r\n  ],\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\nexport class AnneOfGreenGablesComponent implements OnInit {\r\n  @Input() key = '';\r\n  @Input() center: Array<number> = [0, 0];\r\n  @Input() zoom = 14;\r\n  @Input() mapType = 'dreamy';\r\n  @Input() poi: boolean = true;\r\n  @Input() traffic: boolean = false;\r\n  @Output() lastCenter: EventEmitter<Point2D> = new EventEmitter();\r\n  @Output() counterMove: EventEmitter<number> = new EventEmitter();\r\n  @Output() selectedMarkerlng: EventEmitter<Point2D> = new EventEmitter();\r\n  public _map: any;\r\n  public marker: any;\r\n  public layerGroup: any;\r\n  public circleMarker: any;\r\n  public circleLayerGroup: any;\r\n  private layerTemp: any;\r\n  public activeMarker: Array<Point2D> = new Array<Point2D>();\r\n  public markermarker: any;\r\n  public markersIndex: any;\r\n  public Layers: any;\r\n  public removeLayers: any;\r\n\r\n  Lat: any;\r\n  lng: any;\r\n  public currentLocation: Array<number> = [];\r\n  public movecenter!: Array<number>;\r\n  x: any;\r\n  y: any;\r\n  arr: Array<number> = [];\r\n  public counter: number = 0;\r\n  public selectedIcon = leafletNeshan.icon({\r\n    iconUrl: '../src/assets/icon/marker-selected.png',\r\n    iconSize: [35, 40]\r\n  });\r\n  public unselectedIcon = leafletNeshan.icon({\r\n    iconUrl: '../src/assets/icon/marker-not-selected.png',\r\n    iconSize: [35, 40]\r\n  });\r\n  constructor() {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.initMap();\r\n    this._emitLastCenter();\r\n    this.circleLayerGroup = leafletNeshan.layerGroup().addTo(this._map);\r\n    this.layerGroup = leafletNeshan.layerGroup().addTo(this._map);\r\n  }\r\n\r\n  initMap() {\r\n    this._map = new leafletNeshan.Map('map', {\r\n      key: this.key,\r\n      center: this.center,\r\n      zoom: this.zoom,\r\n      poi: this.poi,\r\n      maptype: this.mapType,\r\n      traffic: this.traffic,\r\n    });\r\n    leafletNeshan.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {\r\n      attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors',\r\n      maxZoom: 20\r\n    }).addTo(this._map);\r\n    this._map.locate({ setView: true, maxZoom: 16 });\r\n    this._map.on('locationfound', (e: any) => {\r\n      this.layerTemp = leafletNeshan.circle(e.latlng, e.accuracy - 50).addTo(e.target);\r\n      this.circleLayerGroup = leafletNeshan.layerGroup().addLayer(this.layerTemp).addTo(e.target);\r\n      this.currentLocation = e.latlng;\r\n    });\r\n  }\r\n  private _emitLastCenter() {\r\n    this._map.on('moveend', (_ev: any) => {\r\n      this.lastCenter.emit(this._map.getCenter() as Point2D);\r\n      this.counter++;\r\n      this.counterMove.emit(this.counter);\r\n    });\r\n  }\r\n\r\n  public concatMarkers(markers: Array<Point2D>) {\r\n    markers.forEach((item) => {\r\n      leafletNeshan.marker([item.lat, item.lng], { icon: this.unselectedIcon }).on('click', (ev: any) => {\r\n        this.Layers = this.layerGroup.getLayers();\r\n        this.Layers.forEach((element: any) => {  if (element instanceof leafletNeshan.Marker) { element.setIcon(this.unselectedIcon); } });\r\n        ev.target.setIcon(this.selectedIcon);\r\n      }).addTo(this.layerGroup);\r\n    });\r\n  }\r\n\r\n  public removeMarkers() {\r\n    this.layerGroup.clearLayers();\r\n  }\r\n\r\n  public onLocationFound(e: any) {\r\n    const layerTemp = leafletNeshan.circle(e.latlng, e.accuracy - 50).addTo(e.target);\r\n    this.layerGroup = leafletNeshan.layerGroup().addLayer(layerTemp).addTo(e.target);\r\n    this.currentLocation = e.latlng;\r\n  }\r\n\r\n  public moveToCurrentLocation() {\r\n    this._map.setView(this.currentLocation);\r\n  }\r\n  public selectMarker(item: Point2D): void {\r\n    this.layerGroup.getLayers().find((x: { lat: number; lng: number; }) => x.lat === item.lat && x.lng === item.lng).setIcon(this.selectedIcon);\r\n  }\r\n  public unSelectMarker(item: Point2D): void {\r\n    this.layerGroup.getLayers().find((x: { lat: number; lng: number; }) => x.lat === item.lat && x.lng === item.lng).setIcon(this.unselectedIcon);\r\n  }\r\n}\r\n\r\nexport class Point2D {\r\n  public lat: number = 0;\r\n  public lng: number = 0;\r\n  on: any;\r\n  setIcon: any;\r\n\r\n  constructor() {\r\n    this.lat = 0;\r\n    this.lng = 0;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { AnneOfGreenGablesComponent } from './anne-of-green-gables.component';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AnneOfGreenGablesComponent\r\n  ],\r\n  imports: [\r\n  ],\r\n  exports: [\r\n    AnneOfGreenGablesComponent\r\n  ]\r\n})\r\nexport class AnneOfGreenGablesModule { }\r\n","/*\r\n * Public API Surface of anne-of-green-gables\r\n */\r\n\r\nexport * from './lib/anne-of-green-gables.service';\r\nexport * from './lib/anne-of-green-gables.component';\r\nexport * from './lib/anne-of-green-gables.module';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":";;;MAKa,wBAAwB;IAEnC,iBAAiB;;qHAFN,wBAAwB;yHAAxB,wBAAwB,cAFvB,MAAM;2FAEP,wBAAwB;kBAHpC,UAAU;mBAAC;oBACV,UAAU,EAAE,MAAM;iBACnB;;;ACDD,MAAM,aAAa,GAAG,OAAO,CAAC,mCAAmC,CAAC,CAAC;MAqBtD,0BAA0B;IAsCrC;QArCS,QAAG,GAAG,EAAE,CAAC;QACT,WAAM,GAAkB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAC/B,SAAI,GAAG,EAAE,CAAC;QACV,YAAO,GAAG,QAAQ,CAAC;QACnB,QAAG,GAAY,IAAI,CAAC;QACpB,YAAO,GAAY,KAAK,CAAC;QACxB,eAAU,GAA0B,IAAI,YAAY,EAAE,CAAC;QACvD,gBAAW,GAAyB,IAAI,YAAY,EAAE,CAAC;QACvD,sBAAiB,GAA0B,IAAI,YAAY,EAAE,CAAC;QAOjE,iBAAY,GAAmB,IAAI,KAAK,EAAW,CAAC;QAQpD,oBAAe,GAAkB,EAAE,CAAC;QAI3C,QAAG,GAAkB,EAAE,CAAC;QACjB,YAAO,GAAW,CAAC,CAAC;QACpB,iBAAY,GAAG,aAAa,CAAC,IAAI,CAAC;YACvC,OAAO,EAAE,wCAAwC;YACjD,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;SACnB,CAAC,CAAC;QACI,mBAAc,GAAG,aAAa,CAAC,IAAI,CAAC;YACzC,OAAO,EAAE,4CAA4C;YACrD,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;SACnB,CAAC,CAAC;KAEF;IAED,QAAQ;QACN,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,gBAAgB,GAAG,aAAa,CAAC,UAAU,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACpE,IAAI,CAAC,UAAU,GAAG,aAAa,CAAC,UAAU,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC/D;IAED,OAAO;QACL,IAAI,CAAC,IAAI,GAAG,IAAI,aAAa,CAAC,GAAG,CAAC,KAAK,EAAE;YACvC,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,OAAO,EAAE,IAAI,CAAC,OAAO;SACtB,CAAC,CAAC;QACH,aAAa,CAAC,SAAS,CAAC,yCAAyC,EAAE;YACjE,WAAW,EAAE,0EAA0E;YACvF,OAAO,EAAE,EAAE;SACZ,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACpB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC,CAAC;QACjD,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,EAAE,CAAC,CAAM;YACnC,IAAI,CAAC,SAAS,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,QAAQ,GAAG,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;YACjF,IAAI,CAAC,gBAAgB,GAAG,aAAa,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;YAC5F,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,MAAM,CAAC;SACjC,CAAC,CAAC;KACJ;IACO,eAAe;QACrB,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,CAAC,GAAQ;YAC/B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAa,CAAC,CAAC;YACvD,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACrC,CAAC,CAAC;KACJ;IAEM,aAAa,CAAC,OAAuB;QAC1C,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI;YACnB,aAAa,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,EAAO;gBAC5F,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC;gBAC1C,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,OAAY,OAAQ,IAAI,OAAO,YAAY,aAAa,CAAC,MAAM,EAAE;oBAAE,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;iBAAE,EAAE,CAAC,CAAC;gBACnI,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aACtC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAC3B,CAAC,CAAC;KACJ;IAEM,aAAa;QAClB,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;KAC/B;IAEM,eAAe,CAAC,CAAM;QAC3B,MAAM,SAAS,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,QAAQ,GAAG,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;QAClF,IAAI,CAAC,UAAU,GAAG,aAAa,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;QACjF,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,MAAM,CAAC;KACjC;IAEM,qBAAqB;QAC1B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;KACzC;IACM,YAAY,CAAC,IAAa;QAC/B,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,CAAC,CAAgC,KAAK,CAAC,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;KAC7I;IACM,cAAc,CAAC,IAAa;QACjC,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,CAAC,CAAgC,KAAK,CAAC,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;KAC/I;;uHAxGU,0BAA0B;2GAA1B,0BAA0B,uRAjB3B;;;;;;;;;;;GAWT;2FAMU,0BAA0B;kBAnBtC,SAAS;mBAAC;oBACT,QAAQ,EAAE,0BAA0B;oBACpC,QAAQ,EAAE;;;;;;;;;;;GAWT;oBACD,SAAS,EAAE;wBACT,mCAAmC;qBACpC;oBACD,aAAa,EAAE,iBAAiB,CAAC,IAAI;iBACtC;0EAEU,GAAG;sBAAX,KAAK;gBACG,MAAM;sBAAd,KAAK;gBACG,IAAI;sBAAZ,KAAK;gBACG,OAAO;sBAAf,KAAK;gBACG,GAAG;sBAAX,KAAK;gBACG,OAAO;sBAAf,KAAK;gBACI,UAAU;sBAAnB,MAAM;gBACG,WAAW;sBAApB,MAAM;gBACG,iBAAiB;sBAA1B,MAAM;;MAkGI,OAAO;IAMlB;QALO,QAAG,GAAW,CAAC,CAAC;QAChB,QAAG,GAAW,CAAC,CAAC;QAKrB,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;QACb,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;KACd;;;MC7HU,uBAAuB;;oHAAvB,uBAAuB;qHAAvB,uBAAuB,iBARhC,0BAA0B,aAK1B,0BAA0B;qHAGjB,uBAAuB,YANzB,EACR;2FAKU,uBAAuB;kBAVnC,QAAQ;mBAAC;oBACR,YAAY,EAAE;wBACZ,0BAA0B;qBAC3B;oBACD,OAAO,EAAE,EACR;oBACD,OAAO,EAAE;wBACP,0BAA0B;qBAC3B;iBACF;;;ACdD;;;;ACAA;;;;;;"}